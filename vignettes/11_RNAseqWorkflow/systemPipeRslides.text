<!DOCTYPE html>
  <head>

 <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>\VignetteIndexEntry{RNA-Seq Workflow Template}  | GEN242</title>
<link rel="stylesheet" type="text/css" href="../css/syntax.css">
<link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">-->
<link rel="stylesheet" type="text/css" href="../css/modern-business.css">
<link rel="stylesheet" type="text/css" href="../css/lavish-bootstrap.css">
<link rel="stylesheet" type="text/css" href="../css/customstyles.css">
<link rel="stylesheet" type="text/css" href="../css/theme-blue.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="../js/jquery.navgoco.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="../js/toc.js"></script>
<script src="../js/customscripts.js"></script>
<link rel="shortcut icon" href="../common_images/favicon.ico" type="image/x-icon">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->







 

<script>
  $(function () {
      $('[data-toggle="tooltip"]').tooltip()
  })
</script>



  </head>

<body>

   <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a class="fa fa-home fa-lg navbar-brand" href="home.html">&nbsp;<span class="projectTitle"> Data Analysis in Genome Biology</span></a>

        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                



















                
                
                
                
                <li><a href="https://piazza.com/class/ilbslqb3j2ovy" target="_blank">Piazza</a></li>
                
                
                
                
                
                <li><a href="https://github.com/tgirke/GEN242" target="_blank">Github Repo</a></li>
                
                
                
                


                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->

                <li class="dropdown">
                    
                    
                    
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        
                        <li><a href="https://cran.r-project.org/" target="_blank">CRAN</a></li>
                        
                        
                        
                        
                        
                        <li><a href="http://bioconductor.org/" target="_blank">Bioconductor</a></li>
                        
                        
                        
                        
                        
                        <li><a href="http://manuals.bioinformatics.ucr.edu/home/R_BioCondManual" target="_blank">R & Bioconductor Manual</a></li>
                        
                        
                        
                        
                        
                        <li><a href="https://guides.github.com/activities/hello-world/" target="_blank">GitHub</a></li>
                        
                        
                        
                        
                        
                        <li><a href="http://jekyllrb.com/" target="_blank">Jekyll</a></li>
                        
                        
                        
                        
                        
                        <li><a href="http://girke.bioinformatics.ucr.edu/" target="_blank">Girke Lab</a></li>
                        
                        
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/documentation-theme-jekyll" target="_blank">Jekyll Doc Theme</a></li>
                        
                        
                        
                        

                    </ul>
                </li>
                
                


                <!-- special insertion -->

               
                
                
                <!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "GEN242 feedback";
var body = "I have some feedback about the \VignetteIndexEntry{RNA-Seq Workflow Template} page: ";
body += window.location.href;
body += "";
var uri = "mailto:?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>


                <!--uncomment this block if you want simple search instead of algolia-->
                <li>
                     <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="../js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                        SimpleJekyllSearch.init({
                            searchInput: document.getElementById('search-input'),
                            resultsContainer: document.getElementById('results-container'),
                            dataSource: '../search.json',
                            searchResultTemplate: '<li><a href="{url}" title="\VignetteIndexEntry{RNA-Seq Workflow Template}">{title}</a></li>',
                        noResultsText: 'No results found.',
                                limit: 10,
                                fuzzy: true,
                        })
                    </script>
                     <!--end search-->
                </li>

            
        </div>
        <!-- /.container -->
</nav>


    <!-- Page Content -->
    <div class="container">
        <div class="col-lg-12">&nbsp;</div>


<!-- Content Row -->
<div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">

        <script>

            $(document).ready(function() {
                // Initialize navgoco with default options
                $("#mysidebar").navgoco({
                    caretHtml: '',
                    accordion: true,
                    openClass: 'active', // open
                    save: false, // leave false or nav highlighting doesn't work right
                    cookie: {
                        name: 'navgoco',
                        expires: false,
                        path: '/'
                    },
                    slide: {
                        duration: 400,
                        easing: 'swing'
                    }
                });

                $("#collapseAll").click(function(e) {
                    e.preventDefault();
                    $("#mysidebar").navgoco('toggle', false);
                });

                $("#expandAll").click(function(e) {
                    e.preventDefault();
                    $("#mysidebar").navgoco('toggle', true);
                });

            });

        </script>


        



















        <ul id="mysidebar" class="nav">

            <span class="siteTagline">GEN242</span>
            <span class="versionTagline">Spring 2016</span>

            
            
            
                
            
            <li><a href="#">Home</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/home.html">Introduction</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_syllabus.html">Syllabus</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Internal</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_internal.html">Internal Resources</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Schedule</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_schedule.html">Course Schedule</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Lecture Slides</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_01.html">Course Introduction</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_02.html">Molbiol for Bioinformatics</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_03.html">Databases and Software</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_04.html">DNA Sequencing</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_05.html">Introduction to R</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_06.html">Sequence Alignments</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_07.html">Programming in R</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_08.html">Multiple Alignments</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_09.html">Short Read Alignments</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_10.html">NGS Analysis Basics</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_11.html">Gene Expression Analysis</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_slides_12.html">NGS Workflows</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Homework</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_homework_01.html">HW1 - Online Tools</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_homework_02.html">HW2 - Biocluster/Linux</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_homework_03.html">HW3 - Introduction to R</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_homework_04.html">HW4 - Pairwise Alignments</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_09.html">HW5 - Programming in R</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_08.html">HW6 - Sequence Analysis</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">GitHub</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_tutorial_01.html">GitHub</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Biocluster & Linux</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_tutorial_02.html">Basic Tutorial</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Introduction to R</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_01.html">1. Overview</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_02.html">2. R Package Repositories</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_03.html">3. Installation of R and Add-on Packages</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_04.html">4. Getting Around</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_05.html">5. Basic Syntax</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_06.html">6. Data Types</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_07.html">7. Data objects</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_08.html">8. Important Utilities</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_09.html">9. Operators and Calculations</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_10.html">10. Reading and Writing External Data</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_11.html">11. Useful R Functions</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_12.html">12. Graphics in R</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_13.html">13. Analysis Routine</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_14.html">14. Session Info</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rbasics_15.html">15. References</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Programming in R</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_01.html">1. Overview</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_02.html">2. Control Structures</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_03.html">3. Loops</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_04.html">4. Functions</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_05.html">5. Useful Utilities</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_06.html">6. Running R Scripts</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_07.html">7. Building R Packages</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_08.html">8. Programming Exercises</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_09.html">9. Homework 5</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_10.html">10. Session Info</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Programming_in_R_11.html">11. References</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">NGS Analysis Basics</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_01.html">1. Overview</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_02.html">2. Package Requirements</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_03.html">3. Strings in R Base</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_04.html">4. Sequences in Bioconductor</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_05.html">5. NGS Sequences</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_06.html">6. Range Operations</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_07.html">7. Transcript Ranges</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_08.html">8. Homework 6</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_09.html">9. Session Info</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_Rsequences_10.html">10. References</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">NGS Workflow Overview</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_1.html">1. Introduction</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_2.html">2. Getting Started</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_3.html">3. Workflow overview</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_4.html">4. Workflow templates</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_5.html">5. Version information</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeR_6.html">6. References</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">RNA-Seq Workflow</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_01.html">1. Introduction</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_02.html">2. Sample definitions and environment settings</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_03.html">3. Read preprocessing</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_04.html">4. Alignments</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_05.html">5. Read quantification per annotation range</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_06.html">6. Analysis of differentially expressed genes with edgeR</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_07.html">7. Clustering and heat maps</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_08.html">8. Version Information</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_09.html">9. Funding</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_systemPipeRNAseq_10.html">10. References</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Paper Presentations</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_paper_presentations.html">Paper Presentations</a></li>
                    

                    

                    
                    
                </ul>
                
                
            
            <li><a href="#">Course Projects</a>
                <ul>
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_00.html">Overview</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_01.html">ChIP-Seq1 - Motif Prediction</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_02.html">ChIP-Seq2 - Peak Callers</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_03.html">RNA-Seq1 - RNA-Seq Aligners</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_04.html">RNA-Seq2 - DEG Methods</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_05.html">VAR-Seq1 - Variant Callers</a></li>
                    

                    

                    
                    
                    
                    
                    <li><a href="../mydoc/mydoc_project_06.html">VAR-Seq2 - Functional Prediction</a></li>
                    

                    

                    
                    
                </ul>
                
                
                


                <!-- if you aren't using the accordion, uncomment this block:

                     <p class="external">
                         <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
                     </p>
                 -->

    </div>
    <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
    <script>$("li.active").parents('li').toggleClass("active");</script>


            <!-- Content Column -->
            <div class="col-md-9">
                
                <div class="post-header">
   <h1 class="post-title-main">\VignetteIndexEntry{RNA-Seq Workflow Template}</h1>
</div>

<div class="post-content">

   

<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>


<div id="toc"></div>


<!--
    
    <a target="_blank" href="https://github.com/tgirke/manuals/tree/master/mydoc//vignettes/11_RNAseqWorkflow/systemPipeRslides.text" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    
-->
%\VignetteEngine{knitr::knitr} %\VignettePackage{systemPipeR}

% Generate vignette with knitr % R CMD Sweave --engine=knitr::knitr
--pdf systemPipeRNAseq.Rnw

\documentclass{article}
%<<style, eval=TRUE, echo=FALSE, results=tex>>=
%BiocStyle::latex(use.unsrturl=FALSE)
%@
<<style-knitr, eval=TRUE, echo=FALSE, results="asis">>=
BiocStyle::latex(use.unsrturl=FALSE)
@

\usepackage[authoryear,round]{natbib}
\bibliographystyle{plainnat}
\def\bibsection{\section{References}}

\usepackage{graphicx}
\usepackage{color}
\usepackage{hyperref}
\usepackage{url}
\usepackage{float}

%\newcommand{\comment}[1]{}
%\newcommand{\Rfunction}[1]}
%\newcommand{\Robject}[1]}
%\newcommand{\Rpackage}[1]}
%\newcommand{\Rmethod}[1]}
\newcommand{\Rfunarg}[1]}
%\newcommand{\Rclass}[1]}
    
% Define header and footer area with fandyhdr package (see: http://www.ctan.org/tex-archive/macros/latex/contrib/fancyhdr/fancyhdr.pdf)
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\rhead{\nouppercase{\leftmark}}
\lhead{\textit{systemPipeR RNA-Seq Workflow}}
\rfoot{\thepage}


\\begin{document}

&lt;<setup, include=FALSE, cache=FALSE>&gt;= library(knitr) \# set
global chunk options for knitr opts\_chunk\$set(comment=NA,
warning=FALSE, message=FALSE, fig.path='figure/systemPipeR-')
options(formatR.arrow=TRUE, width=95) unlink("test.db") @

\title{RNA-Seq workflow template: Some Descriptive Title}\author{Project ID: RNAseq\_PI\_Name\_Organism\_Jun2014 \\
    Project PI: First Last (first.last@inst.edu)\\
        Author of Report: First Last (first.last@inst.edu)}\maketitle
\tableofcontents

\section{Introduction}
This report describes the analysis of an RNA-Seq project from Dr. First
Last's lab which studies the gene expression changes of ... in
\textit{organism} .... The experimental design is as follows...

\section{Sample definitions and environment settings}
\subsection{Environment settings and input data}
Typically, the user wants to record here the sources and versions of the
reference genome sequence along with the corresponding annotations. In
the provided sample data set all data inputs are stored in a
\Robject{data} subdirectory and all results will be written to a
separate \Robject{results} directory, while the
\Robject{systemPipeRNAseq.Rnw} script and the \Robject{targets} file are
expected to be located in the parent directory. The R session is
expected to run from this parent directory.

To run this sample report, mini sample FASTQ and reference genome files
can be downloaded from
\href{http://biocluster.ucr.edu/~tgirke/projects/systemPipeR_test_data.zip}{\textcolor{blue}{here}}.
The chosen data set
\href{http://www.ncbi.nlm.nih.gov/sra/?term=SRP010938}{\textcolor{blue}{SRP010938}}
contains 18 paired-end (PE) read sets from \textit{Arabidposis thaliana}
\citep{Howard2013-fq}. To minimize processing time during testing, each
FASTQ file has been subsetted to 90,000-100,000 randomly sampled PE
reads that map to the first 100,000 nucleotides of each chromosome of
the \textit{A. thalina} genome. The corresponding reference genome
sequence (FASTA) and its GFF annotion files (provided in the same
download) have been truncated accordingly. This way the entire test
sample data set is less than 200MB in storage space. A PE read set has
been chosen for this test data set for flexibility, because it can be
used for testing both types of analysis routines requiring either SE
(single end) reads or PE reads.

\subsection{Required packages and resources}
The \Rpackage{systemPipeR} package needs to be loaded to perform the
analysis steps shown in this report \citep{Girke2014-oy}.
&lt;<eval=TRUE>&gt;= library(systemPipeR) @

If applicable load custom functions not provided by
\Rpackage{systemPipeR} &lt;<eval=FALSE>&gt;=
source("systemPipeRNAseq\_Fct.R") @

\subsection{Experiment definition provided by \Robject{targets} file}
The \href{run:targets.txt}{\Robject{targets}} file defines all FASTQ
files and sample comparisons of the analysis workflow.
&lt;<eval=TRUE>&gt;= targetspath &lt;- system.file("extdata",
"targets.txt", package="systemPipeR") targets &lt;-
read.delim(targetspath, comment.char = "\#")\[,1:4\] targets @

\section{Read preprocessing}\subsection{FASTQ quality report}
The following \Rfunction{seeFastq} and \Rfunction{seeFastqPlot}
functions generate and plot a series of useful quality statistics for a
set of FASTQ files including per cycle quality box plots, base
proportions, base-level quality trends, relative k-mer diversity, length
and occurrence distribution of reads, number of reads above quality
cutoffs and mean quality distribution. The results are written to a PDF
file named
\href{run:./results/fastqReport.pdf}{\Robject{fastqReport.pdf}}.

&lt;<eval=FALSE>&gt;= args &lt;- systemArgs(sysma="tophat.param",
mytargets="targets.txt") fqlist &lt;- seeFastq(fastq=infile1(args),
batchsize=100000, klength=8) pdf("./results/fastqReport.pdf", height=18,
width=4\*length(fqlist)) seeFastqPlot(fqlist) dev.off() @
\begin{figure}[H]
  \centering
   \includegraphics[width=18cm]{fastqReport.pdf}
   \caption{QC report for 18 FASTQ files.}
   \label{fig:fastqreport}
\end{figure}
\section{Alignments}\subsection{Read mapping with \Rfunction{Bowtie2/Tophat2}}
The NGS reads of this project will be aligned against the reference
genome sequence using \Robject{Bowtie2/TopHat2}
\citep{Kim2013-vg, Langmead2012-bs}. The parameter settings of the
aligner are defined in the \Robject{tophat.param} file.
&lt;<eval=FALSE>&gt;= args &lt;- systemArgs(sysma="tophat.param",
mytargets="targets.txt") sysargs(args)\[1\] \# Command-line parameters
for first FASTQ file @ Submission of alignment jobs to compute cluster,
here using 72 CPU cores (18 \Robject{qsub} processes each with 4 CPU
cores). &lt;<eval=FALSE>&gt;= moduleload(modules(args))
system("bowtie2-build ./data/tair10.fasta ./data/tair10.fasta")
resources &lt;- list(walltime="20:00:00", nodes=paste0("1:ppn=",
cores(args)), memory="10gb") reg &lt;- clusterRun(args,
conffile=".BatchJobs.R", template="torque.tmpl", Njobs=18, runid="01",
resourceList=resources) waitForJobs(reg) @ Check whether all BAM files
have been created &lt;<eval=FALSE>&gt;= file.exists(outpaths(args)) @

\subsection{Read and alignment stats}
The following provides an overview of the number of reads in each sample
and how many of them aligned to the reference. &lt;<eval=FALSE>&gt;=
read\_statsDF &lt;- alignStats(args=args) write.table(read\_statsDF,
"results/alignStats.xls", row.names=FALSE, quote=FALSE, sep="\t") @
&lt;<eval=TRUE>&gt;= read.table(system.file("extdata", "alignStats.xls",
package="systemPipeR"), header=TRUE)\[1:4,\] @

\subsection{Create symbolic links for viewing BAM files in IGV}
The \Rfunction{symLink2bam} function creates symbolic links to view the
BAM alignment files in a genome browser such as IGV. The corresponding
URLs are written to a file with a path specified under
\Robject{urlfile}, here \href{run:./results/IGVurl.txt}{IGVurl.txt}.
&lt;<eval=FALSE>&gt;= symLink2bam(sysargs=args, htmldir=c("\~/.html/",
"somedir/"), urlbase="http://biocluster.ucr.edu/\~tgirke/",
urlfile="./results/IGVurl.txt") @

\section{Read quantification per annotation range}\subsection{Read counting with \Rfunction{summarizeOverlaps} in parallel mode using multiple cores}
Reads overlapping with annotation ranges of interest are counted for
each sample using the \Rfunction{summarizeOverlaps} function
\citep{Lawrence2013-kt}. The read counting is preformed for exonic gene
regions in a non-strand-specific manner while ignoring overlaps among
different genes. Subsequently, the expression count values are
normalized by \textit{reads per kp per million mapped reads} (RPKM). The
raw read count table
(\href{run:./results/countDFeByg.xls}{countDFeByg.xls}) and the
correspoding RPKM table
(\href{run:./results/rpkmDFeByg.xls}{rpkmDFeByg.xls}) are written to
separate files in the \Robject{results} directory of this project.
Parallelization is achieved with the \Rpackage{BiocParallel} package,
here using 8 CPU cores. &lt;<eval=FALSE>&gt;=
library("GenomicFeatures"); library(BiocParallel) txdb &lt;-
loadDb("./data/tair10.sqlite") eByg &lt;- exonsBy(txdb, by=c("gene"))
bfl &lt;- BamFileList(outpaths(args), yieldSize=50000,
index=character()) multicoreParam &lt;- MulticoreParam(workers=8);
register(multicoreParam); registered() counteByg &lt;- bplapply(bfl,
function(x) summarizeOverlaps(eByg, x, mode="Union", ignore.strand=TRUE,
inter.feature=FALSE, singleEnd=TRUE)) countDFeByg &lt;-
sapply(seq(along=counteByg), function(x)
assays(counteByg\[\[x\]\])\$counts) rownames(countDFeByg) &lt;-
names(rowRanges(counteByg\[\[1\]\])); colnames(countDFeByg) &lt;-
names(bfl) rpkmDFeByg &lt;- apply(countDFeByg, 2, function(x)
returnRPKM(counts=x, ranges=eByg)) write.table(countDFeByg,
"results/countDFeByg.xls", col.names=NA, quote=FALSE, sep="\t")
write.table(rpkmDFeByg, "results/rpkmDFeByg.xls", col.names=NA,
quote=FALSE, sep="\t") @ Sample of data slice of count table
&lt;<eval=FALSE>&gt;= read.delim("results/countDFeByg.xls", row.names=1,
check.names=FALSE)\[1:4,1:5\] @ Sample of data slice of RPKM table
&lt;<eval=FALSE>&gt;= read.delim("results/rpkmDFeByg.xls", row.names=1,
check.names=FALSE)\[1:4,1:4\] @ Note, for most statistical differential
expression or abundance analysis methods, such as \Rpackage{edgeR} or
\Rpackage{DESeq2}, the raw count values should be used as input. The
usage of RPKM values should be restricted to specialty applications
required by some users, \textit{e.g.} manually comparing the expression
levels among different genes or features.

\subsection{Sample-wise correlation analysis}
The following computes the sample-wise Spearman correlation coefficients
from the } transformed expression values generated with
the \Rpackage{DESeq2} package. After transformation to a distance
matrix, hierarchical clustering is performed with the \Rfunction{hclust}
function and the result is plotted as a dendrogram
(\href{run:./results/sample_tree.pdf}{sample\_tree.pdf}).
&lt;<eval=FALSE>&gt;= library(DESeq2, quietly=TRUE); library(ape,
warn.conflicts=FALSE) countDF &lt;-
as.matrix(read.table("./results/countDFeByg.xls")) colData &lt;-
data.frame(row.names=targetsin(args)$SampleName, condition=targetsin(args)$Factor)
dds &lt;- DESeqDataSetFromMatrix(countData = countDF, colData = colData,
design = \~ condition) d &lt;- cor(assay(rlog(dds)), method="spearman")
hc &lt;- hclust(dist(1-d)) pdf("results/sample\_tree.pdf")
plot.phylo(as.phylo(hc), type="p", edge.col="blue", edge.width=2,
show.node.label=TRUE, no.margin=TRUE) dev.off() @
\begin{figure}[H]
  \centering
   \includegraphics[width=10cm]{sample_tree.pdf}
   \caption{Correlation dendrogram of samples.}
   \label{fig:sample_tree}
\end{figure}
\section{Analysis of differentially expressed genes with \Rpackage{edgeR}}
The analysis of differentially expressed genes (DEGs) is performed with
the glm method from the \Rpackage{edgeR} package
\citep{Robinson2010-uk}. The sample comparisons used by this analysis
are defined in the header lines of the
\href{run:targets.txt}{\Robject{targets}} file starting with
\texttt{<CMP>}. &lt;<eval=FALSE>&gt;= library(edgeR) countDF &lt;-
read.delim("countDFeByg.xls", row.names=1, check.names=FALSE) targets
&lt;- read.delim("targets.txt", comment="\#") cmp &lt;-
readComp(file="targets.txt", format="matrix", delim="-") edgeDF &lt;-
run\_edgeR(countDF=countDF, targets=targets, cmp=cmp\[\[1\]\],
independent=FALSE, mdsplot="") @

Add custom functional descriptions. Skip this step if \Robject{desc.xls}
is not available. &lt;<eval=FALSE>&gt;= desc &lt;-
read.delim("data/desc.xls") desc &lt;- desc\[!duplicated(desc\[,1\]),\]
descv &lt;- as.character(desc\[,2\]); names(descv) &lt;-
as.character(desc\[,1\]) edgeDF &lt;- data.frame(edgeDF,
Desc=descv\[rownames(edgeDF)\], check.names=FALSE) write.table(edgeDF,
"./results/edgeRglm\_allcomp.xls", quote=FALSE, sep="\t", col.names =
NA) @

Filter and plot DEG results for up and down regulated genes. The
definition of '\textit{up}' and '\textit{down}' is given in the
corresponding help file. To open it, type \Rfunction{?filterDEGs} in the
R console. &lt;<eval=FALSE>&gt;= edgeDF &lt;-
read.delim("results/edgeRglm\_allcomp.xls", row.names=1,
check.names=FALSE) pdf("results/DEGcounts.pdf") DEG\_list &lt;-
filterDEGs(degDF=edgeDF, filter=c(Fold=2, FDR=1)) dev.off()
write.table(DEG\_list\$Summary, "./results/DEGcounts.xls", quote=FALSE,
sep="\t", row.names=FALSE) @
\begin{figure}[H]
  \centering
   \includegraphics[width=10cm]{DEGcounts.pdf}
   \caption{Up and down regulated DEGs with FDR of 1\%.}
   \label{fig:DEGcounts}
\end{figure}
The function \Rfunction{overLapper} can compute Venn intersects for
large numbers of sample sets (up to 20 or more) and \Rfunction{vennPlot}
can plot 2-5 way Venn diagrams. A useful feature is the possiblity to
combine the counts from several Venn comparisons with the same number of
sample sets in a single Venn diagram (here for 4 up and down DEG sets).
&lt;<eval=FALSE>&gt;= vennsetup &lt;-
overLapper(DEG\_list$Up[6:9], type="vennsets") vennsetdown <- overLapper(DEG_list$Down\[6:9\],
type="vennsets") pdf("results/vennplot.pdf") vennPlot(list(vennsetup,
vennsetdown), mymain="", mysub="", colmode=2, ccol=c("blue", "red"))
dev.off() @
\begin{figure}[H]
  \centering
   \includegraphics[width=14cm]{vennplot.pdf}
   \caption{Venn Diagram for 4 Up and Down DEG Sets.}
   \label{fig:vennplot}
\end{figure}
\subsection{GO term enrichment analysis of DEGs}\subsubsection{Obtain gene-to-GO mappings}
The following shows how to obtain gene-to-GO mappings from
\Rpackage{biomaRt} (here for \textit{A. thaliana}) and how to organize
them for the downstream GO term enrichment analysis. Alternatively, the
gene-to-GO mappings can be obtained for many organisms from
Bioconductor's \Robject{*.db} genome annotation packages or GO
annotation files provided by various genome databases. For each
annotation this relatively slow preprocessing step needs to be performed
only once. Subsequently, the preprocessed data can be loaded with the
\Rfunction{load} function as shown in the next subsection.
&lt;<eval=FALSE>&gt;= library("biomaRt") listMarts() \# To choose
BioMart database m &lt;- useMart("ENSEMBL\_MART\_PLANT");
listDatasets(m) m &lt;- useMart("ENSEMBL\_MART\_PLANT",
dataset="athaliana\_eg\_gene") listAttributes(m) \# Choose data types
you want to download go &lt;- getBM(attributes=c("go\_accession",
"tair\_locus", "go\_namespace\_1003"), mart=m) go &lt;-
go\[go\[,3\]!="",\]; go\[,3\] &lt;- as.character(go\[,3\])
go\[go\[,3\]=="molecular\_function", 3\] &lt;- "F";
go\[go\[,3\]=="biological\_process", 3\] &lt;- "P";
go\[go\[,3\]=="cellular\_component", 3\] &lt;- "C" go\[1:4,\]
dir.create("./data/GO") write.table(go,
"data/GO/GOannotationsBiomart\_mod.txt", quote=FALSE, row.names=FALSE,
col.names=FALSE, sep="\t") catdb &lt;-
makeCATdb(myfile="data/GO/GOannotationsBiomart\_mod.txt", lib=NULL,
org="", colno=c(1,2,3), idconv=NULL) save(catdb,
file="data/GO/catdb.RData") @

\subsubsection{Batch GO term enrichment analysis}
Apply the enrichment analysis to the DEG sets obtained the above
differential expression analysis. Note, in the following example the
} filter is set here to an unreasonably high value,
simply because of the small size of the toy data set used in this
vignette. Batch enrichment analysis of many gene sets is performed with
the \Rfunction{GOCluster\_Report} function. When
}, it returns all GO terms passing the p-value
cutoff specified under the } arguments. When
}, it returns only the GO terms specified under
the } argument. The given example shows how a GO slim
vector for a specific organism can be obtained from BioMart.\
&lt;<eval=FALSE>&gt;= load("data/GO/catdb.RData") DEG\_list &lt;-
filterDEGs(degDF=edgeDF, filter=c(Fold=2, FDR=50), plot=FALSE) up\_down
&lt;-
DEG\_list$UporDown; names(up_down) <- paste(names(up_down), "_up_down", sep="") up <- DEG_list$Up;
names(up) &lt;- paste(names(up), "\_up", sep="") down &lt;-
DEG\_list\$Down; names(down) &lt;- paste(names(down), "\_down", sep="")
DEGlist &lt;- c(up\_down, up, down) DEGlist &lt;-
DEGlist\[sapply(DEGlist, length) &gt; 0\] BatchResult &lt;-
GOCluster\_Report(catdb=catdb, setlist=DEGlist, method="all",
id\_type="gene", CLSZ=2, cutoff=0.9, gocats=c("MF", "BP", "CC"),
recordSpecGO=NULL) library("biomaRt"); m &lt;-
useMart("ENSEMBL\_MART\_PLANT", dataset="athaliana\_eg\_gene") goslimvec
&lt;- as.character(getBM(attributes=c("goslim\_goa\_accession"),
mart=m)\[,1\]) BatchResultslim &lt;- GOCluster\_Report(catdb=catdb,
setlist=DEGlist, method="slim", id\_type="gene", myslimv=goslimvec,
CLSZ=10, cutoff=0.01, gocats=c("MF", "BP", "CC"), recordSpecGO=NULL) @

\subsubsection{Plot batch GO term results}
The \Robject{data.frame} generated by \Rfunction{GOCluster\_Report} can
be plotted with the \Rfunction{goBarplot} function. Because of the
variable size of the sample sets, it may not always be desirable to show
the results from different DEG sets in the same bar plot. Plotting
single sample sets is achieved by subsetting the input data frame as
shown in the first line of the following example. &lt;<eval=FALSE>&gt;=
gos &lt;- BatchResultslim\[grep("M6-V6\_up\_down",
BatchResultslim\$CLID), \] gos &lt;- BatchResultslim
pdf("GOslimbarplotMF.pdf", height=8, width=10); goBarplot(gos,
gocat="MF"); dev.off() goBarplot(gos, gocat="BP") goBarplot(gos,
gocat="CC") @

\begin{figure}[H]
  \centering
   \includegraphics[width=20cm]{GOslimbarplotMF.pdf}
   \caption{GO Slim Barplot for MF Ontology.}
   \label{fig:GOMF}
\end{figure}
\section{Clustering and heat maps}
The following example performs hierarchical clustering on the
} transformed expression matrix subsetted by the DEGs
identified in the above differential expression analysis. It uses a
Pearson correlation-based distance measure and complete linkage for
cluster joining. &lt;<eval=FALSE>&gt;= library(pheatmap) geneids &lt;-
unique(as.character(unlist(DEG\_list\[\[1\]\]))) y &lt;-
assay(rlog(dds))\[geneids, \] pdf("heatmap1.pdf") pheatmap(y,
scale="row", clustering\_distance\_rows="correlation",
clustering\_distance\_cols="correlation") dev.off() @

\begin{figure}[H]
  \centering
   \includegraphics[width=12cm]{heatmap1.pdf}
   \caption{Heat map with hierarchical clustering dendrograms of DEGs.}
   \label{fig:heatmap}
\end{figure}
\section{Version Information}
&lt;<sessionInfo, results='asis'>&gt;= toLatex(sessionInfo()) @

\section{Funding}
This project was supported by funds from the National Institutes of
Health (NIH).

\bibliography{bibtex}
\\end{document}


<div class="tags">
    
</div>



</div>



<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 UC Riverside. All rights reserved. <br />
 Site last generated: May 1, 2016 <br />
<p><img src="../common_images/company_logo.png/></p>
                </div>
            </div>
</footer>

            </div><!-- /.row -->

    </div>    <!-- /.container -->

</body>


</html>

